<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="/js/gesture-detector.js"></script>
    <script src="/js/gesture-handler.js"></script>
  </head>
  <body style='margin : 0px; overflow: hidden;'>
    <audio id="audioID" volume="0.2" loop> <source src="/assets/Sound/bgSound.mp3" type="audio/mp3"></audio>
    <a-scene embedded arjs='trackingMethod: best; detectionMode: mono_and_matrix; matrixCodeType: 3x3;' gesture-detector>
      <a-assets>
        <audio id="sound" src="/assets/Sound/modelSound.mp3" preload="auto" crossorigin="anonymous"></audio>
      </a-assets>

      <a-marker id="markerA" type='barcode' value='2' smooth="true"
      cursor="fuse: false; rayOrigin: mouse;"
      raycaster="objects: .clickable"
      emitevents="true"
      cursor="fuse: false; rayOrigin: mouse;">
        <!-- Title -->
        <a-entity
        geometry="primitive: plane; height: 0.5; width: 4"
        material="color: #9e9e9e"
        position="0 0 -1.604"
        rotation="-90 0 0">
        </a-entity>
        <a-text
        anchor="center"
        align="center"
        position="-0.002 0.256 -1.575"
        rotation="-90 0 0"
        font="dejavu"
        value="Data Aktual Covid-19 Indonesia"
        animation="property: components.text.material.uniforms.color.value; type: color; to: red; dir: alternate; loop: true"></a-text>

        <!-- Content -->
        <a-entity
        geometry="primitive: plane; height: 0.5; width: 2"
        material="color: grey"
        position="-2.133 0 -0.742"
        rotation="-90 0 0">
        </a-entity>
        <a-text id="dataConfirmed"
        anchor="center"
        align="center"
        position="-2.122 0.256 -0.742"
        rotation="-90 0 0"
        font="dejavu"></a-text>

        <!-- Content -->
        <a-entity
        geometry="primitive: plane; height: 0.5; width: 2.1"
        material="color: grey"
        position="-2.133 0 0.742"
        rotation="-90 0 0">
        </a-entity>
        <a-text id="dataActive"
        anchor="center"
        align="center"
        position="-2.068 0.256 0.742"
        rotation="-90 0 0"
        font="dejavu"></a-text>

        <!-- Content -->
        <a-entity
        geometry="primitive: plane; height: 0.5; width: 2"
        material="color: grey"
        position="2.133 0 -0.742"
        rotation="-90 0 0">
        </a-entity>
        <a-text id="dataRecovered"
        anchor="center"
        align="center"
        position="2.133 0.256 -0.742"
        rotation="-90 0 0"
        font="dejavu"></a-text>

        <!-- Content -->
        <a-entity
        geometry="primitive: plane; height: 0.5; width: 2.2"
        material="color: grey"
        position="2.133 0 0.742"
        rotation="-90 0 0">
        </a-entity>
        <a-text id="dataDeaths"
        anchor="center"
        align="center"
        position="2.151 0.256 0.742"
        rotation="-90 0 0"
        font="dejavu"></a-text>

        <!-- Model -->
        <a-entity
        id="bowser-model"
        class="clickable"
        gltf-model="url(/assets/Indonesia/scene.gltf)"
        position="0.063 0 0"
        scale="0.03 0.03 0.03"
        gesture-handler></a-entity>
      </a-marker>

      <a-marker id="mark2" type='barcode' value='4'>
        <!-- Title -->
        <a-entity
        geometry="primitive: plane; height: 0.5; width: 2.8"
        material="color: grey"
        position="0.013 0 -1.378"
        rotation="-90 0 0">
        </a-entity>
        <a-text
        anchor="center"
        align="center"
        position="-0.002 0.256 -1.368"
        rotation="-90 0 0"
        font="dejavu"
        value="Bentuk Virus Covid-19"
        animation="property: components.text.material.uniforms.color.value; type: color; to: red; dir: alternate; loop: true"></a-text>

        <!-- Model -->
        <a-entity
        gltf-model="url(/assets/Covid/scene.gltf)"
        position="-0.008 0 -0.411"
        scale="0.4 0.4 0.4"
        rotation="0 -90.000 90.000"></a-entity>
      </a-marker>

      <a-marker id="mark3" type='barcode' value='6'>
        <!-- Model -->
        <a-entity
        soundhandler
        animation-mixer="clip: *;"
        gltf-model="url(/assets/Doctor/scene.gltf)"
        position="0 0 0.8"
        scale="3.5 3.5 3.5"
        rotation="-72.875 113.956 -113.947"></a-entity>
      </a-marker>

      <a-entity sound="src: #sound;" autoplay="false" poolSize="2"></a-entity>
      <a-entity camera></a-entity>
    </a-scene>

    <script>
      AFRAME.registerComponent('soundhandler', {
        tick: function () {
          var entity = document.querySelector('[sound]');
          if (document.querySelector('#mark3').object3D.visible == true) {
            entity.components.sound.playSound();
          } else {
            entity.components.sound.pauseSound();
          }
        }
      });
      document.getElementById("audioID").autoplay = true;
      document.getElementById("audioID").volume = 0.1;
      async function loadData() {
        let url = 'https://corona.coollabs.work/country/indonesia';
        let obj = await (await fetch(url)).json();

        $("#dataConfirmed").attr("value", "Kasus : "+obj.Confirmed);
        $("#dataActive").attr("value", "Dirawat : "+obj.Active);
        $("#dataRecovered").attr("value", "Sembuh : "+obj.Recovered);
        $("#dataDeaths").attr("value", "Meninggal : "+obj.Deaths);
      }
      loadData();


    </script>
  </body>
</html>