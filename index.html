<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="/js/gesture-detector.js"></script>
    <script src="/js/gesture-handler.js"></script>
  </head>
  <body style='margin : 0px; overflow: hidden;'>
    <a-scene embedded arjs='trackingMethod: best; detectionMode: mono_and_matrix; matrixCodeType: 3x3;' gesture-detector>
      <a-assets>
        <audio id="sound" src="/assets/Sound/Sound.mp3" preload="auto" crossorigin="anonymous"></audio>
      </a-assets>

      <a-marker id="mark1" type='barcode' value='2' smooth="true"
      cursor="fuse: false; rayOrigin: mouse;"
      raycaster="objects: .clickable"
      emitevents="true"
      cursor="fuse: false; rayOrigin: mouse;"
      id="markerA">

        <a-text
        anchor="center"
        align="center"
        position="-0.002 0.256 -1.368"
        rotation="-79.607 0.081 -0.348"
        font="dejavu"
        value="Data Aktual Covid-19 Indonesia"
        animation="property: components.text.material.uniforms.color.value; type: color; to: red; dir: alternate; loop: true"></a-text>

        <a-text id="dataConfirmed"
        anchor="center"
        align="center"
        position="-1.253 0.256 -0.742"
        rotation="-79.507 -1.556 0.687"
        font="dejavu"></a-text>

        <a-text id="dataActive"
        anchor="center"
        align="center"
        position="-1.373 0.256 0.742"
        rotation="-80.214 0.501 -1.400"
        font="dejavu"></a-text>

        <a-text id="dataRecovered"
        anchor="center"
        align="center"
        position="1.250 0.256 -0.742"
        rotation="-79.637 -2.390 2.071"
        font="dejavu"></a-text>

        <a-text id="dataDeaths"
        anchor="center"
        align="center"
        position="1.251 0.256 0.742"
        rotation="-79.325 2.754 -3.011"
        font="dejavu"></a-text>

        <a-entity
        id="bowser-model"
        class="clickable"
        gltf-model="url(/assets/Indonesia/scene.gltf)"
        position="0.063 0 0"
        scale="0.02 0.02 0.02"
        gesture-handler></a-entity>
      </a-marker>

      <a-marker id="mark2" type='barcode' value='4'>
        <a-text
        anchor="center"
        align="center"
        position="-0.002 0.256 -1.368"
        rotation="-79.607 0.081 -0.348"
        font="dejavu"
        value="Bentuk Virus Covid-19"
        animation="property: components.text.material.uniforms.color.value; type: color; to: red; dir: alternate; loop: true"></a-text>

        <a-entity
        gltf-model="url(/assets/Covid/scene.gltf)"
        position="0 0 -0.500"
        scale="0.3 0.3 0.3"
        rotation="0 -90.000 90.000"></a-entity>
      </a-marker>

      <a-marker id="mark3" type='barcode' value='6'>
        <a-entity
        soundhandler
        animation-mixer="clip: *;"
        gltf-model="url(/assets/Doctor/scene.gltf)"
        position="0 0.031 0.657"
        scale="3 3 3"
        rotation="-72.875 113.956 -113.947"></a-entity>
      </a-marker>

      <a-entity sound="src: #sound;" autoplay="false"></a-entity>
      <a-entity camera></a-entity>
    </a-scene>

    <script>
      AFRAME.registerComponent('soundhandler', {
        tick: function () {
          var entity = document.querySelector('[sound]');
          if (document.querySelector('#mark3').object3D.visible == true) {
            entity.components.sound.playSound();
          } else {
            entity.components.sound.pauseSound();
          }
        }
      });
      async function loadData() {
        let url = 'https://corona.coollabs.work/country/indonesia';
        let obj = await (await fetch(url)).json();

        $("#dataConfirmed").attr("value", "Kasus : "+obj.Confirmed);
        $("#dataActive").attr("value", "Dirawat : "+obj.Active);
        $("#dataRecovered").attr("value", "Sembuh : "+obj.Recovered);
        $("#dataDeaths").attr("value", "Meninggal : "+obj.Deaths);
      }
      loadData();


    </script>
  </body>
</html>